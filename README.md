# PDF処理ツール

このツールは、PDFファイルを処理、変更、および管理するためのPythonアプリケーションです。特定の条件に基づいてデータを抽出し、リネームし、ファイルを結合する機能を提供します。このアプリケーションは、PDFの操作、テキストの抽出、その他の情報の管理、およびグラフィカルユーザーインターフェイス（GUI）操作を処理するためのいくつかのライブラリを使用しています。

## 目次

1. [必要環境](#必要環境)
2. [インストール](#インストール)
3. [使用方法](#使用方法)
4. [コード概要](#コード概要)
5. [クラスと関数の説明](#クラスと関数の説明)

## 必要環境

- Windows
- Python 3.9.13
- 以下のPythonライブラリが必要です:
  - `tkinter`
  - `PyPDF2`
  - `pdfminer`
  - `reportlab`
  - `dateutil`

## インストール

1. Python 3.9.13をインストールします。
2. 必要なライブラリをインストールします。以下のコマンドを使用してください。

    ```bash
    pip install PyPDF2 pdfminer.six reportlab python-dateutil
    ```

## 使用方法

1. このプログラムを実行する前に、`休日.csv`という名前のファイルが同じディレクトリに存在する必要があります。`休日.csv`ファイルには、休日の日付が`YYYY/MM/DD`形式で記載されている必要があります。

2. プログラムを実行するには、以下のコマンドを使用します。

    ```bash
    python your_script_name.py
    ```

3. GUIが起動し、「フォルダ参照」ボタンをクリックしてPDFファイルが格納されているフォルダを選択します。

4. 選択したフォルダ内のPDFファイルを処理し、必要に応じてリネームや結合が行われます。

## コード概要

このアプリケーションは、複数のPDFファイルを処理し、指定された条件に基づいてデータを抽出して処理を行います。PDFの処理には、`pdfminer`と`PyPDF2`ライブラリを使用しています。また、`reportlab`ライブラリを用いてPDFファイルへの書き込みも行います。

- **GUIの作成**: `tkinter`ライブラリを使用して、フォルダを選択するためのGUIを提供します。
- **PDF処理クラス**: PDFファイルの読み込み、データ抽出、リネーム、結合を行うための複数のクラスが定義されています。
- **ファイル処理のメインロジック**: メイン関数`main_process()`では、PDFファイルの内容を解析し、必要な情報を抽出します。

## クラスと関数の説明

### `Sheet` クラス

`Sheet`は、PDF処理のための基本クラスであり、以下のメソッドを持ちます：

- `trim_end_of_word()`: 文字列の末尾から空白を取り除くメソッド。
- `extraction_for_quotation()`: 見積書の情報を抽出するメソッド。
- `calculate_confirm_day()`: 発送日から確定日を計算するメソッド。
- `write_confirm_day()`: 確定日をPDFに書き込むメソッド。
- `create_page_number_pdf()`: ページ番号を付けたPDFを作成するメソッド。
- `get_page_size()`: PDFページのサイズ（幅と高さ）を取得するメソッド。
- `rename_file()`: ファイル名を変更するメソッド。

### その他のクラス

他にも、特定のPDFファイルに対する処理を行うためのクラスが定義されています：

- `Final_check_sheet` クラス: 最終確認票用の処理を行う。
- `Detail_sheet` クラス: 仕様明細書の処理を行う。
- `Quotation_sheet` クラス: 見積書の処理を行う。
- `Change_specifications_sheet` クラス: 仕様変更の仕様明細書を処理する。
- `Cancel_sheet` クラス: キャンセル明細書の処理を行う。

### `main_process()` 関数

指定されたフォルダ内のPDFファイルを処理し、適切なクラスのインスタンスを生成して処理を行います。

### `merge_files_for_posting()` 関数

処理後のPDFファイルを条件に基づいて結合する関数です。

## 注意事項

- `holiday`リストを定義するために、`休日.csv`ファイルが必要です。
- `reportlab`で使用するフォントがシステムにインストールされていることを確認してください。

## `休日.csv` のサンプル

以下は、`休日.csv`ファイルの内容のサンプルです。日付と祝日の名称が記載されています。

| date       | holiday_name            |
|------------|-------------------------|
| 2024/01/01 | 元日                    |
| 2024/01/08 | 成人の日                |
| 2024/02/11 | 建国記念の日            |
| 2024/02/12 | 建国記念の日 振替休日  |
| 2024/03/20 | 春分の日                |
| ...        | ...                     |

上記のように、5行目以降のデータは省略されていますが、実際のファイルには祝日が引き続き記載されています。
